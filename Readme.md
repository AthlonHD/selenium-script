#使用说明

### 钉钉自动做题脚本-v0.2

目前支持的作业类型：
数学、物理、化学 的 AMT / MT / AT

目前支持的功能：
把所有题目做对，跑完流程，并且输出过程中报错部分的原因

#### 环境准备：
`操作系统：Windows、OS X
`

`python环境：python 3.8+ 推荐
`

`chrome浏览器： 最新版本即可
`

#### 使用方法：

##### Windows

1.安装mitmproxy
    
    双击主目录下的mitmproxy-installer.exe进行安装，默认安装路径即可，
    安装完成后无需立即打开

2.设置mitmproxy的环境变量

    右键"此电脑" → 点击"属性" → 点击"高级系统设置" →
    选择"高级"选项卡 → 点击"环境变量" → 
    
    在 用户变量 和 系统变量 中的 PATH 变量中都编辑添加值
    
    添加的值为：
    安装mitmproxy的路径\bin
    
    如未更改默认安装路径，则路径即为：
    C:\ProgramFiles (x86)\mitmproxy\bin
    
    都添加完成后点击确定即可
    
3.更改脚本中的路径

    以编辑的形式打开MitmproxyAddon.py
    
    更改代码的38处：
    38      with open('\更改这里的路径\info.json', 'w') as f:
    
    将"\更改这里的路径\"修改为脚本程序文件夹的主目录地址
    
    例：
    38      with open('I:\AutomatedDingTalk\info.json', 'w') as f:
    
    随后保存即可
    
    注：如果路径存在于桌面上可能会导致报错！

4.安装selenium库

    使用cmd命令行输入指令：
    pip3 install selenium

5.运行mitmproxy代理程序

    打开cmd，切换到脚本程序文件夹所在的目录位置
    
    复制MitmproxyAddon.py文件顶部注释内需要运行的代码，
    或复制下方代码，输入在cmd窗口中后回车
    
    mitmweb --set http2=false -p 1010 -s MitmproxyAddon.py
    
    随后会开启一个浏览器窗口，无需关闭，挂在后台即可

6.填入带有token的做题页面的链接

    打开脚本程序主目录内的"url.txt"文件，将原有的链接删除后，
    粘贴入需要进行做题的链接保存后即可关闭
    
7.运行脚本
    
    打开cmd，切换到脚本程序文件夹所在的目录位置
    
    输入以下代码：
        python RunTask.py

7.5.运行脚本后的**第一次**使用时安装证书
    
    运行RunTask后
    
    当弹出一个新的浏览器窗口后，在新弹出的浏览器地址栏中
    输入网址并回车：
        mitm.it
    选择windows版本的证书，点击下载并进行安装
    
    安装证书的过程，只需要一直点击下一步即可~
    
    *仅第一次使用时，需要进行此操作下载安装证书！
    
8.之后按照cmd窗口页面操作指引进行操作即可

####机型模拟
    
    将想要模拟的机型名称放在此文件内保存即可
    
        deviceName.txt
    
    具体机型可以在"可模拟的机型列表.txt"中找到



#### 已知问题：

AT流程做作业时，可能会因为刷新、前端页面渲染、页面加载等原因导致流程被迫中断